<ion-header>

  <ion-navbar>
    <ion-title>{{parentPage | parentReadable | firstUpper}}</ion-title>
  </ion-navbar>

</ion-header>


<ion-content class="bgc" (click)="resetInterval()">
  <div *ngIf="parentPage === 'presentStudents'">
    <ion-list inset class="fill">
      <ion-grid class="horizontal-align-center">
        <ion-row class="buttonRow">
          <ion-col>
            <div class="titleRoom">
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>
      <ion-content class="scrollable">
        <div *ngFor="let student of this.studentService.data | mapValues" class="scrollableInside">
          <div *ngIf="this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT">
            <ion-card>
              <ion-item  (click)="studentTapped($event, this.studentService.data.get(student.key)._id)">
                <ion-icon name="walk" item-left></ion-icon>
                {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
                <div item-right>
                  <page-student-info-button [thisStudentLocation]="this.studentService.data.get(student.key).location"></page-student-info-button>
                </div>
              </ion-item>
            </ion-card>
          </div>
        </div>
        <div *ngFor="let student of this.studentService.data | mapValues">
          <div *ngIf="this.studentService.data.get(student.key).location === checkinService.CHECKED_OUT">
            <ion-card>
              <ion-item class="absentRow"  (click)="studentTapped($event, this.studentService.data.get(student.key)._id)">
                <ion-icon name="walk" item-left></ion-icon>
                {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
                <div item-right>
                  <page-student-info-button [thisStudentLocation]="this.studentService.data.get(student.key).location"></page-student-info-button>
                </div>
              </ion-item>
            </ion-card>
          </div>
        </div>
      </ion-content>
    </ion-list>
    <ion-grid>
      <ion-row class="countRow">
        <ion-col>
          <ion-item class="bg">
            <span class="countHeader" item-right>
              Total Students Present:
            </span>
            <span class="presentCount" item-right>
              {{this.studentService.data|presentCount}}
            </span>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
  <ion-list inset>
    <div *ngIf="parentPage === 'napStudents'">
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT">
          <ion-card>
            <ion-card-content>
              <ion-grid>
                <ion-row>
                  <ion-col width-33 class="infoCol">
                    <ion-icon name="walk" item-left></ion-icon>
                    {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
                  </ion-col>
                  <ion-col width-67>
                    <page-nap-buttons [thisStudent]="this.studentService.data.get(student.key)._id" (napTime)='updateNap($event, this.studentService.data.get(student.key)._id)'></page-nap-buttons>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </div>
      </div>
    </div>

    <div *ngIf="parentPage === 'therapy'">
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="this.studentService.data.get(student.key).location.includes(checkinService.CHECKED_OUT_THERAPY)">
          <ion-card>
            <ion-item>
              <ion-icon name="walk" item-left></ion-icon>
              {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
              <div item-right>
                <page-action-button [thisStudent]="this.studentService.data.get(student.key)._id" [userID]="this.userID" [studentLocation]="this.studentService.data.get(student.key).location" (checkedOut)='revert($event)' [grandParentPage]="parentPage"></page-action-button>
              </div>
            </ion-item>
          </ion-card>
        </div>
      </div>
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="!this.studentService.data.get(student.key).location.includes(checkinService.CHECKED_OUT_THERAPY) && this.studentService.data.get(student.key).location !==  checkinService.CHECKED_OUT  && this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT_NURSE">
          <ion-card>
            <ion-item>
              <ion-icon name="walk" item-left></ion-icon>
              {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
              <div item-right>
                <page-action-button [thisStudent]="this.studentService.data.get(student.key)._id" [userID]="this.userID" [studentLocation]="this.studentService.data.get(student.key).location" (checkedOut)='revert($event)' [grandParentPage]="parentPage"></page-action-button>
              </div>
            </ion-item>
          </ion-card>
        </div>
      </div>
    </div>

    <div *ngIf="parentPage === 'generic'">
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="this.studentService.data.get(student.key).location === checkinService.CHECKED_OUT_NURSE">
          <ion-card>
            <ion-item>
              <ion-icon name="walk" item-left></ion-icon>
              {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
              <div item-right>
                <page-action-button [thisStudent]="this.studentService.data.get(student.key)._id" [userID]="this.userID" [studentLocation]="this.studentService.data.get(student.key).location" (checkedOut)='revert($event)' [grandParentPage]="parentPage"></page-action-button>
              </div>
            </ion-item>
          </ion-card>
        </div>
      </div>
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT && this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT_THERAPY && this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT_NURSE">
          <ion-card>
            <ion-item>
              <ion-icon name="walk" item-left></ion-icon>
              {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
              <div item-right>
                <page-action-button [thisStudent]="this.studentService.data.get(student.key)._id" [userID]="this.userID" (checkedOut)='revert($event)' [grandParentPage]="parentPage"></page-action-button>
              </div>
            </ion-item>
          </ion-card>
        </div>
      </div>
    </div>

    <div *ngIf="parentPage === 'signout'">
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="this.studentService.data.get(student.key).location !== checkinService.CHECKED_OUT">
          <ion-card>
            <ion-item>
              <ion-icon name="walk" item-left></ion-icon>
              {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
              <div item-right>
                <page-action-button [thisStudent]="this.studentService.data.get(student.key)._id" [userID]="this.userID" (checkedOut)='revert($event)' [grandParentPage]="parentPage"></page-action-button>
              </div>
            </ion-item>
          </ion-card>
        </div>
      </div>
    </div>

    <div *ngIf="parentPage === 'checkin'">
      <div *ngFor="let student of this.studentService.data | mapValues">
        <div *ngIf="this.studentService.data.get(student.key).location === checkinService.CHECKED_OUT">
          <ion-card>
            <ion-item>
              <ion-icon name="walk" item-left></ion-icon>
              {{this.studentService.data.get(student.key).fName}} {{this.studentService.data.get(student.key).lName}}
              <div item-right>
                <page-action-button [thisStudent]="this.studentService.data.get(student.key)._id" [userID]="this.userID" (checkedOut)='revert($event)' [grandParentPage]="parentPage"></page-action-button>
              </div>
            </ion-item>
          </ion-card>
        </div>
      </div>
    </div>

  </ion-list>
  <div class="vertical-align-content">
    <ion-grid>
      <ion-row class="buttonRow">
        <ion-col>
          <div *ngIf="parentPage === 'signout' && !isListEmpty()">
            <button ion-button block (click)="removeStudents()">Checkout</button>
          </div>
          <div *ngIf="parentPage === 'checkin' && !isListEmpty()">
            <button ion-button block (click)="addStudents()">Check In</button>
          </div>
          <div *ngIf="parentPage === 'napStudents' && !isListEmpty()">
            <button ion-button block (click)="updateAll(this.studentService)">Update</button>
          </div>
        </ion-col>
      </ion-row>
      <ion-row class="emptyRow" *ngIf="isListEmpty()">
        <ion-col>
          <div *ngIf="this.parentPage === 'checkin'">
            <ion-item class="emptyItem">
              <ion-icon class="emptyIcon" name="archive"></ion-icon>
            </ion-item>
            <ion-item class="emptyText">
              All your students are currently checked in.
            </ion-item>
          </div>
          <div *ngIf="this.parentPage === 'signout'">
            <ion-item class="emptyItem">
              <ion-icon class="emptyIcon" name="archive"></ion-icon>
            </ion-item>
            <ion-item class="emptyText">
              All your students are currently checked out.
            </ion-item>
          </div>
          <div *ngIf="this.parentPage === 'therapy' || this.parentPage === 'napStudents'|| this.parentPage === 'generic'">
            <ion-item class="emptyItem">
              <ion-icon class="emptyIcon" name="archive"></ion-icon>
            </ion-item>
            <ion-item class="emptyText">
              No students are present in this class.
            </ion-item>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>
